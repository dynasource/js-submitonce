{"version":3,"sources":["dmn.a.submitonce.es6"],"names":[],"mappings":"62BAAA,OAAO,gBAAP,CAAwB,MAAxB,CAAgC,UAAY,CACxC,GAAI,WAAJ,CAAe,CACX,WAAY,KADD,CAAf,EAGH,CAJD,EAMA;;MAGM,W,YAEF;;;OAIA,oBAAY,MAAZ,CAAoB,kCAChB,KAAK,MAAL,CAAc,MAAd,CACA,GAAI,OAAQ,WAAW,kBAAX,CAA8B,KAAK,MAAL,CAAY,QAA1C,CAAZ,CAEA,KAAK,MAAL,CAAY,KAAZ,CAAqB,KAAK,MAAL,CAAY,KAAZ,GAAsB,SAAvB,CAAoC,gBAApC,CAAuD,KAAK,MAAL,CAAY,KAAvF,CACA,KAAK,MAAL,CAAY,OAAZ,CAAuB,KAAK,MAAL,CAAY,OAAZ,GAAwB,SAAzB,CAAsC,IAAtC,CAA6C,KAAK,MAAL,CAAY,KAA/E,CAEA,GAAI,QAAU,KAAd,CAAqB,CACjB,KAAK,SAAL,CAAe,KAAf,EACH,CACJ,CAED;;;0EAIU,K,CAAO,gBAEb,IAAK,GAAI,EAAT,GAAc,MAAd,CAAqB,CACjB,GAAI,MAAO,MAAM,CAAN,CAAX,CACA,GAAI,OAAO,KAAP,mCAAO,IAAP,KAAgB,QAApB,CAA8B,CAC1B,SACH,CAED,KAAK,gBAAL,CAAsB,OAAtB,CAA+B,SAAC,KAAD,CAAW,CACtC,MAAM,cAAN,GACA,MAAO,OAAK,uBAAL,CAA6B,MAAM,SAAnC,CAAP,CACH,CAHD,EAIH,CACJ,CAED;;+EAGwB,M,CAAQ,CAC5B,GAAI,aAAc,KAAK,cAAL,CAAoB,MAApB,CAAlB,CAEA,WAAW,UAAX,CAAsB,WAAtB,EACA,WAAW,UAAX,CAAsB,MAAtB,EAEA,WAAW,UAAM,CACb,WAAW,UAAX,CAAsB,WAAtB,EACA,WAAW,UAAX,CAAsB,MAAtB,EACH,CAHD,CAGG,KAAK,MAAL,CAAY,OAHf,EAKA,MAAO,MAAP,CACH,CAED;;;6DAIe,M,CAAQ,CACnB,GAAI,KAAK,WAAL,GAAqB,SAAzB,CAAoC,CAChC,KAAK,WAAL,CAAmB,SAAS,aAAT,CAAuB,OAAO,OAA9B,CAAnB,CACA,KAAK,WAAL,CAAiB,SAAjB,CAA6B,KAAK,MAAL,CAAY,KAAzC,CACA,KAAK,WAAL,CAAiB,YAAjB,CAA8B,OAA9B,CAAuC,OAAO,YAAP,CAAoB,OAApB,CAAvC,EACA,KAAK,WAAL,CAAiB,YAAjB,CAA8B,UAA9B,CAA0C,IAA1C,EACA,OAAO,UAAP,CAAkB,YAAlB,CAA+B,KAAK,WAApC,CAAiD,MAAjD,EAEH,CACD,MAAO,MAAK,WAAZ,CACH,CAED;;;uDAIkB,M,CAAQ,CACtB,OAAO,YAAP,CAAoB,OAApB,CAA6B,cAA7B,EACH,CAED;;;qDAIkB,M,CAAQ,CACtB,OAAO,YAAP,CAAoB,OAApB,CAA6B,EAA7B,EACH,CAED;;;qEAI0B,Q,CAAU,CAChC,GAAI,MAAJ,CACA,GAAI,SAAU,CAAC,wBAAD,CAA2B,sBAA3B,CAAmD,gBAAnD,CAAd,CAEA,IAAK,GAAI,EAAT,GAAc,QAAd,CAAuB,CACnB,GAAI,QAAS,QAAQ,CAAR,CAAb,CACA,MAAQ,SAAS,MAAT,EAAiB,QAAjB,CAAR,CAEA,GAAI,QAAU,IAAd,CAAoB,CAChB,GAAI,QAAU,gBAAd,CAAgC,CAC5B,MAAQ,CAAC,KAAD,CAAR,CACH,CAFD,IAEO,IAAI,MAAM,MAAN,GAAiB,CAArB,CAAwB,CAC3B,SACH,CAED,MAAO,MAAP,CACH,CACJ,CACD,MAAO,MAAP,CACH,C","file":"dmn.a.submitonce.js","sourcesContent":["window.addEventListener('load', function () {\r\n    new SubmitOnce({\r\n        'selector': 'btn'\r\n    });\r\n});\r\n\r\n/**\r\n * SubmitOnce prevents multiple formsubmissions\r\n */\r\nclass SubmitOnce {\r\n\r\n    /**\r\n     * Sets config and click events\r\n     * @param config\r\n     */\r\n    constructor(config) {\r\n        this.config = config;\r\n        let nodes = SubmitOnce.getNodesBySelector(this.config.selector);\r\n\r\n        this.config.label = (this.config.label === undefined) ? 'Please wait...' : this.config.label;\r\n        this.config.timeout = (this.config.timeout === undefined) ? 1000 : this.config.label;\r\n\r\n        if (nodes !== false) {\r\n            this.setEvents(nodes);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets click events on html nodes (submit buttons)\r\n     * @param nodes\r\n     */\r\n    setEvents(nodes) {\r\n\r\n        for (let i in nodes) {\r\n            let node = nodes[i];\r\n            if (typeof node !== 'object') {\r\n                continue;\r\n            }\r\n\r\n            node.addEventListener('click', (event) => {\r\n                event.preventDefault();\r\n                return this.preventDoubleSubmission(event.toElement);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Prevents double submission\r\n     */\r\n    preventDoubleSubmission(button) {\r\n        let ghostButton = this.getGhostButton(button);\r\n\r\n        SubmitOnce.showButton(ghostButton);\r\n        SubmitOnce.hideButton(button);\r\n\r\n        setTimeout(() => {\r\n            SubmitOnce.hideButton(ghostButton);\r\n            SubmitOnce.showButton(button);\r\n        }, this.config.timeout);\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Gets GhostButton\r\n     * @returns {Element|*}\r\n     */\r\n    getGhostButton(button) {\r\n        if (this.ghostButton === undefined) {\r\n            this.ghostButton = document.createElement(button.tagName);\r\n            this.ghostButton.innerHTML = this.config.label;\r\n            this.ghostButton.setAttribute('class', button.getAttribute('class'));\r\n            this.ghostButton.setAttribute('disabled', true);\r\n            button.parentNode.insertBefore(this.ghostButton, button);\r\n\r\n        }\r\n        return this.ghostButton;\r\n    }\r\n\r\n    /**\r\n     * Hides button\r\n     * @param button\r\n     */\r\n    static hideButton(button) {\r\n        button.setAttribute('style', 'display:none');\r\n    }\r\n\r\n    /**\r\n     * Shows button\r\n     * @param button\r\n     */\r\n    static showButton(button) {\r\n        button.setAttribute('style', '');\r\n    }\r\n\r\n    /**\r\n     * Gets html nodes by selector\r\n     * @param selector\r\n     */\r\n    static getNodesBySelector(selector) {\r\n        var nodes;\r\n        let methods = ['getElementsByClassName', 'getElementsByTagName', 'getElementById'];\r\n\r\n        for (let i in methods) {\r\n            let method = methods[i];\r\n            nodes = document[method](selector);\r\n\r\n            if (nodes !== null) {\r\n                if (method == 'getElementById') {\r\n                    nodes = [nodes];\r\n                } else if (nodes.length === 0) {\r\n                    continue;\r\n                }\r\n\r\n                return nodes;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n"]}